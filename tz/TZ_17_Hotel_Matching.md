# ТЗ-17: Матчинг гостиниц

**Версия:** 1.0
**Дата:** 2026-02-25
**Статус:** Планируется
**Волна:** 4 (Развитие)
**Владелец:** Баландина О.А. (операционные доходы)

---

## 1. Метаданные

| Параметр | Значение |
|----------|----------|
| ID | TZ-17 |
| Название | Матчинг гостиниц |
| Приоритет | Высокий |
| Категория | Автоматизация |
| AUTO-точки | AUTO-015 |
| Экономия | 50 ч/мес |
| Затронутые отделы | Продуктовый отдел, Тарификация |

---

## 2. Проблема (AS-IS)

### 2.1. Текущее состояние

**AUTO-015: Автоматический матчинг гостиниц между системами**
- Ручное сопоставление отелей между САМО-тур, Островок, Броневик и поставщиками
- Время выполнения: 50 ч/мес
- Ошибки приводят к некорректным ценам и бронированиям

### 2.2. Детализация проблемы

1. **Разные названия одного отеля:**
   - САМО: "Rixos Premium Belek"
   - Островок: "Rixos Premium Belek Resort"
   - Поставщик: "RIXOS PREMIUM BELEK 5*"

2. **Частые изменения:**
   - Новые отели появляются еженедельно
   - Отели переименовываются, меняют категорию
   - Требуется постоянная актуализация

3. **Последствия ошибок:**
   - Клиент бронирует не тот отель
   - Неверная цена в системе
   - Финансовые потери на разницу

### 2.3. Боли пользователей

1. **Продуктовый отдел:** Рутинная работа, высокий риск ошибок
2. **Менеджеры продаж:** Несоответствие цен между источниками
3. **Клиенты:** Риск ошибочного бронирования

---

## 3. Цель (TO-BE)

### 3.1. Целевое состояние

1. **Автоматический матчинг** — алгоритм сопоставления по названию, адресу, координатам
2. **Ручная верификация** — только для спорных случаев (<10%)
3. **Единый справочник** — мастер-база отелей со связями

### 3.2. Ожидаемые результаты

| Метрика | AS-IS | TO-BE | Улучшение |
|---------|-------|-------|-----------|
| Ручной матчинг | 50 ч/мес | 8 ч/мес | -84% |
| Точность сопоставления | 85% | 98% | +15% |
| Время на новый отель | 15 мин | 2 мин | -87% |

---

## 4. Объём работ

### 4.1. Включено в ТЗ

| # | Компонент | Описание |
|---|-----------|----------|
| 1 | Мастер-база отелей | Единый справочник с каноническими названиями |
| 2 | Алгоритм матчинга | Нечёткое сравнение (fuzzy matching) по названию, адресу, координатам |
| 3 | Интеграция с источниками | САМО-тур, Островок, Броневик, поставщики |
| 4 | Интерфейс верификации | Веб-интерфейс для ручной проверки спорных случаев |
| 5 | Автообновление | Регулярная синхронизация справочников |
| 6 | Отчёт о качестве | Метрики точности матчинга |

### 4.2. Исключено из ТЗ

- Автоматическое ценообразование (только матчинг)
- Интеграция с booking.com (нет API для B2B)
- Фотографии и описания отелей (только идентификация)

---

## 5. Входные и выходные данные

### 5.1. Входные данные

| Источник | Данные | Формат |
|----------|--------|--------|
| САМО-тур | Справочник отелей | API / XML |
| Островок | Каталог отелей | API |
| Броневик | Каталог отелей | API |
| Поставщики | Справочники | Excel / XML |
| Google Maps | Координаты, адреса | API |

### 5.2. Выходные данные

| Получатель | Данные | Формат |
|------------|--------|--------|
| САМО-тур | Обновлённый справочник | API / XML |
| Продуктовый отдел | Отчёт о матчинге | Excel / Web |
| Системы бронирования | Связи между ID | JSON / API |

---

## 6. Технические требования

### 6.1. Алгоритм матчинга

| Критерий | Вес | Метод |
|----------|-----|-------|
| Название отеля | 40% | Fuzzy matching (Levenshtein, Jaro-Winkler) |
| Город/Страна | 20% | Точное совпадение |
| Координаты | 25% | Расстояние < 500м |
| Категория (звёзды) | 15% | Точное или ±0.5 |

### 6.2. Пороги принятия решений

| Совпадение | Действие |
|------------|----------|
| > 95% | Автоматическое связывание |
| 80-95% | На ручную верификацию |
| < 80% | Отклонение, требует ручного ввода |

### 6.3. Нефункциональные требования

| Требование | Значение |
|------------|----------|
| Время матчинга 1 отеля | < 1 секунда |
| Точность автоматического матчинга | > 95% |
| Частота синхронизации | Ежедневно |
| Размер справочника | До 500 000 отелей |

---

## 7. План реализации

| Фаза | Задачи | Срок | Трудозатраты |
|------|--------|------|--------------|
| 1. Анализ данных | Изучение справочников, выявление паттернов | 2 недели | 60 ч |
| 2. Мастер-база | Проектирование схемы, первичное наполнение | 3 недели | 80 ч |
| 3. Алгоритм матчинга | Разработка, настройка весов, тестирование | 4 недели | 120 ч |
| 4. Интеграции | Подключение САМО, Островок, Броневик | 3 недели | 80 ч |
| 5. Интерфейс верификации | Веб-интерфейс для ручной проверки | 2 недели | 60 ч |
| 6. Тестирование и запуск | Пилот на 10 000 отелей, корректировка | 2 недели | 40 ч |
| **ИТОГО** | | **16 недель** | **440 ч** |

---

## 8. Критерии приёмки

| # | Критерий | Метод проверки |
|---|----------|----------------|
| 1 | Автоматический матчинг >95% отелей | Тест на 1000 отелей |
| 2 | Точность матчинга >98% | Ручная верификация 200 связей |
| 3 | Время обработки нового отеля <1 сек | Замер производительности |
| 4 | Интерфейс верификации работает | Тест 100 спорных случаев |
| 5 | Синхронизация ежедневная | Проверка логов 7 дней |

---

## 9. Риски и митигация

| Риск | Вероятность | Влияние | Митигация |
|------|-------------|---------|-----------|
| Низкое качество данных в источниках | Высокая | Среднее | Предварительная очистка, нормализация |
| Ограничения API агрегаторов | Средняя | Высокое | Альтернативные методы (парсинг, файлы) |
| Ложные совпадения | Средняя | Высокое | Порог 95%, ручная верификация |

---

## 10. Оценка

### 10.1. Трудозатраты

| Роль | Часы |
|------|------|
| Аналитик данных | 100 |
| Разработчик backend | 200 |
| Разработчик frontend | 80 |
| ML-инженер | 40 |
| QA | 20 |
| **ИТОГО** | **440 ч** |

### 10.2. Стоимость

| Статья | Сумма |
|--------|-------|
| Разработка (440 ч × 3 000 ₽) | 1 320 000 ₽ |
| API Google Maps | ~5 000 ₽/мес |
| **ИТОГО (разработка)** | **1 320 000 ₽** |

### 10.3. ROI

| Показатель | Значение |
|------------|----------|
| Экономия времени | 42 ч/мес (50 - 8) |
| Экономия в рублях (L3, 595 ₽/ч) | 299 880 ₽/год |
| Затраты на разработку | 1 320 000 ₽ |
| Срок окупаемости | ~53 месяца |
| Качественные benefits | Снижение ошибок бронирования, улучшение клиентского опыта |

---

*Документ создан: 2026-02-25*
*Версия: 1.0*
